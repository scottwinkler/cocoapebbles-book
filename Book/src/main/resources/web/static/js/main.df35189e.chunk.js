(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5428:function(e,t,a){e.exports=a(5577)},5577:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(22),c=a.n(r),l=a(39);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(20),s=a(138),u=a(139),d=a(5579),h=a(5580),m=a(58),p=a(59),f=a(62),g=a(60),b=a(63),v=a(5),k=a.n(v),E=a(17),y=a(15),w=a(95),j=a(26),O=a.n(j),B=a(54),x=a.n(B),N=Object(E.createMuiTheme)({palette:{primary:{light:O.a[500],main:O.a[700],dark:O.a[900]},secondary:{light:O.a[500],main:O.a[700],dark:O.a[900]}},typography:{useNextVariants:!0}});var C=function(e){return function(t){return o.a.createElement(E.MuiThemeProvider,{theme:N},o.a.createElement(x.a,null),o.a.createElement(e,t))}},S=a(33),T=a(56),P=a.n(T),M=a(55),R=a.n(M);function A(e){return null===e||void 0===e}var I=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).getTotalCharacters=function(e){var t=0;if(e.length>0){t=255*(e.length-1);var a=e[e.length-1];A(a)&&(a="");var n=a.split("\n").length-1;(A(n)||n<0)&&(n=0),t+=a.length+n}return t},a.updateHelperText=function(e){var t=a.parsePages(e),n=t.length,o=a.getTotalCharacters(t);a.setState({totalPages:n,totalCharacters:o})},a.save=function(){a.setEditing(!1);var e=a.props.book.id,t=a.state,n=t.title,o=t.content,r=t.author,c=a.parsePages(o);a.props.isNew?(a.props.createBook({book:{id:"",author:r,title:n,pages:c}}),a.props.removeNewBook()):a.props.updateBook({book:{id:e,author:r,title:n,pages:c}})},a.splitString=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=new RegExp((!0===a?"[^]":".")+"{1,"+t+"}","g");return e.match(n)},a.delete=function(){a.setEditing(!1),a.props.deleteBook({book:a.props.book}),a.props.isNew&&a.props.removeNewBook()},a.parsePages=function(e){var t;t=e.includes("<br/>")?e.split("<br/>"):[e];var n=[],o=!0,r=!1,c=void 0;try{for(var l,i=t[Symbol.iterator]();!(o=(l=i.next()).done);o=!0){var s=l.value,u=a.splitString(s,255);n=n.concat(u)}}catch(d){r=!0,c=d}finally{try{o||null==i.return||i.return()}finally{if(r)throw c}}return n},a.setEditing=function(e){a.setState({editing:e})},a.onChange=function(e){a.setState(Object(S.a)({},e.target.name,e.target.value)),"content"===e.target.name&&a.updateHelperText(e.target.value)},a.renderSummary=function(e){return a.state.editing?o.a.createElement("div",{className:e.container},o.a.createElement("div",{className:e.column},o.a.createElement(y.j,null,"title"),o.a.createElement(y.h,{name:"title",onChange:a.onChange,value:a.state.title,className:k()(e.textfield),margin:"none"})),o.a.createElement("div",{className:e.column},o.a.createElement(y.j,{className:k()(e.textfield)},"author"),o.a.createElement(y.h,{name:"author",onChange:a.onChange,value:a.state.author,margin:"none"})),o.a.createElement("div",{className:e.flex}),o.a.createElement(y.g,{className:k()(Object(S.a)({},"".concat(e.hide),!a.state.editing)),onClick:function(){a.delete()}},o.a.createElement(R.a,null))):o.a.createElement("div",{className:e.flexContainer},o.a.createElement("div",{className:k()(e.title)},'"'+a.state.title+'", id: '+a.props.book.id),o.a.createElement("div",{className:e.flex}),o.a.createElement("div",{className:k()(e.author)},"written by "+a.state.author))},a.renderDetails=function(e){if(a.state.editing)return o.a.createElement("div",{className:e.fullwidth},o.a.createElement(y.j,null,"content [pages: ",a.state.totalPages,"/50, characters: ",a.state.totalCharacters,"/12800]"),o.a.createElement("textarea",{name:"content",value:a.state.content,onChange:a.onChange,className:k()(e.textarea)}));var t=a.state.content;return t=t.replace(new RegExp("<br/>","g"),""),o.a.createElement("div",{className:e.content},t)},a.cancel=function(){var e=a.props.book,t=e.pages.join("<br/>");a.setState({title:e.title,content:t,author:e.author,editing:!1,totalPages:e.pages.length,totalCharacters:a.getTotalCharacters(e.pages)})};var n=e.book.pages.join("<br/>");return a.state={title:e.book.title,content:n,author:e.book.author,editing:!1,totalPages:e.book.pages.length,totalCharacters:a.getTotalCharacters(e.book.pages)},a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state.editing;return o.a.createElement("div",{className:k()(t.card)},o.a.createElement(y.c,null,o.a.createElement(y.f,{expandIcon:o.a.createElement(P.a,null)},this.renderSummary(t)),o.a.createElement(y.e,null,this.renderDetails(t)),o.a.createElement(y.b,null),o.a.createElement(y.d,null,o.a.createElement(y.a,{size:"small",className:k()(Object(S.a)({},"".concat(t.hide),!a)),onClick:function(){e.cancel()}},"Cancel"),o.a.createElement(y.a,{size:"small",color:"primary",className:k()(Object(S.a)({},"".concat(t.hide),!a)),onClick:function(){e.save()}},"Save"),o.a.createElement(y.a,{size:"small",color:"primary",className:k()(Object(S.a)({},"".concat(t.hide),a)),onClick:function(){e.setEditing(!0)}},"Edit"))))}}]),t}(n.Component),J=C(Object(E.withStyles)(function(e){return{root:{margin:"20px"},selected:{backgroundColor:"LightBlue"},card:{padding:"20px"},hide:{display:"none"},textarea:{width:"100%",height:"100%",borderRadius:"5px",border:"thin dotted #333",minHeight:"100px"},fullwidth:{width:"100%"},container:{display:"flex"},column:{flexBasis:"50%"},textfield:{minWidth:"200px",marginRight:"20px"},author:{marginBottom:"auto",marginTop:"auto"},title:{fontSize:"24px"},flexContainer:{display:"flex",width:"100%"},flex:{flex:"1"},content:{whiteSpace:"pre-line"}}},{withTheme:!0})(I)),L=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={newBook:null},a.componentWillMount=function(){var e,t=a.props.router.location.search.split("&"),n=!0,o=!1,r=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var i=c.value.split("="),s=i[0],u=i[1];s.includes("bookId")&&(e=u),a.props.refreshBooks({bookId:e})}}catch(d){o=!0,r=d}finally{try{n||null==l.return||l.return()}finally{if(o)throw r}}},a.createEmptyBook=function(){a.setState({newBook:{author:"Unknown",pages:[],title:"Untitled",id:"N/A"}})},a.renderBooks=function(e,t){return A(e)?null:e.map(function(e,n){var r=null;return r=A(e.id)?Math.floor(9e4*Math.random())+1e4:e.id,o.a.createElement(J,{key:r,index:n,book:e,updateBook:a.props.updateBook,deleteBook:a.props.deleteBook,createBook:a.props.createBook,isNew:t,removeNewBook:a.removeNewBook})})},a.removeNewBook=function(){a.setState({newBook:null})},a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.books,n=t.classes,r=this.renderBooks(a,!1),c=[];A(this.state.newBook)||(c=this.renderBooks([this.state.newBook],!0));var l=c.concat(r);return o.a.createElement("div",{className:k()(n.root)},o.a.createElement(y.i,null,o.a.createElement(y.j,{variant:"h5"},"Cocoapebble's Book Mod"),o.a.createElement("div",{className:n.flex}),o.a.createElement(y.g,{onClick:function(){e.createEmptyBook()}},o.a.createElement(w.a,null)),o.a.createElement(y.g,{onClick:function(){e.props.refreshBooks()}},o.a.createElement(w.b,null))),l)}}]),t}(n.Component),z=C(Object(E.withStyles)(function(e){return{root:{margin:"20px"},flex:{flexGrow:1}}},{withTheme:!0})(L)),D="BOOKS",H="BOOKS_LOADING",W=window.location.href;"/"==W.charAt(W.length-1)&&(W=W.substr(0,W.length-1));var G=W;function K(){return function(e){e(_(!0)),e(function(e){var t="".concat(G,"/books/");fetch(t,{method:"GET"}).then(function(t){t.json().then(function(t){e({type:D,payload:t})})}).catch(function(e){console.log(e)}).finally(function(){e(_(!1))})})}}function U(e){var t=e.book;return function(e){var a="".concat(G,"/books/").concat(t.id);fetch(a,{method:"PATCH",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(function(t){e(K())}).catch(function(e){console.log(e)})}}function V(e){var t=e.book;return function(e){var a="".concat(G,"/books/");fetch(a,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(function(t){e(K())}).catch(function(e){console.log(e)})}}function $(e){var t=e.book;return function(e){var a="".concat(G,"/books/");fetch(a,{method:"DELETE",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(function(t){e(K())}).catch(function(e){console.log(e)})}}function _(e){return{type:H,payload:e}}var q=Object(l.connect)(function(e){return{books:e.books.books,router:e.router}},function(e){return{refreshBooks:Object(i.b)(K,e),createBook:Object(i.b)(V,e),updateBook:Object(i.b)(U,e),deleteBook:Object(i.b)($,e)}})(z),F=function(){return o.a.createElement("div",null,o.a.createElement(d.a,null,o.a.createElement(h.a,{exact:!0,path:"/",component:q})))};var Q=Object(i.c)({books:Object(i.c)({books:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return t.payload;default:return e}},booksLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return t.payload;default:return e}}})}),X=a(21),Y=a(64),Z=Object(X.a)(),ee=Object(s.createLogger)(),te=Object(i.d)(Object(Y.connectRouter)(Z)(Q),Object(i.a)(u.a,ee,Object(Y.routerMiddleware)(Z)));c.a.render(o.a.createElement(l.Provider,{store:te},o.a.createElement(Y.ConnectedRouter,{history:Z},o.a.createElement(F,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[5428,2,1]]]);
//# sourceMappingURL=main.df35189e.chunk.js.map